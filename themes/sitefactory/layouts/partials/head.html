<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="{{ with .Site.Params.themeColor }}{{ . }}{{ else }}#0066cc{{ end }}">
<title>{{ if .IsHome }}{{ with .Site.Params.homepageTitle }}{{ . }}{{ else }}{{ $.Site.Title }}{{ end }}{{ else }}{{ .Title }} | {{ .Site.Title }}{{ end }}</title>

<!-- SEO Meta -->
<meta name="description" content="{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.description }}{{ end }}">
<!-- Prevent indexing of taxonomy/term list pages (no original content) -->
{{ if in (slice "taxonomy" "term") .Kind }}
<meta name="robots" content="noindex, follow">
{{ end }}
<meta name="author" content="{{ .Site.Params.author }}">
<link rel="canonical" href="{{ .Permalink }}">

<!-- Open Graph -->
<meta property="og:title" content="{{ .Title }}">
<meta property="og:description" content="{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.description }}{{ end }}">
<meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
<meta property="og:url" content="{{ .Permalink }}">
<meta property="og:site_name" content="{{ .Site.Title }}">
<meta property="og:locale" content="{{ replace .Site.LanguageCode "-" "_" }}">
{{ $ogImage := "" }}
{{ with .Params.image }}{{ $ogImage = . | absURL }}{{ end }}
{{ if not $ogImage }}{{ with .Site.Params.ogImage }}{{ $ogImage = . | absURL }}{{ end }}{{ end }}
{{ if not $ogImage }}{{ $ogImage = "og-default.png" | absURL }}{{ end }}
<meta property="og:image" content="{{ $ogImage }}">

<!-- Article-specific Open Graph -->
{{ if .IsPage }}
<meta property="article:published_time" content="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">
{{ if ne (.Date.Format "2006-01-02") (.Lastmod.Format "2006-01-02") }}
<meta property="article:modified_time" content="{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}">
{{ end }}
{{ with .Params.tags }}{{ range . }}<meta property="article:tag" content="{{ . }}">{{ end }}{{ end }}
{{ end }}

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ .Title }}">
<meta name="twitter:description" content="{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.description }}{{ end }}">
{{ if $ogImage }}<meta name="twitter:image" content="{{ $ogImage }}">{{ end }}

<!-- Google Search Console -->
{{ with .Site.Params.googleSearchConsoleVerification }}
<meta name="google-site-verification" content="{{ . }}">
{{ end }}

<!-- RSS Discovery -->
{{ with .OutputFormats.Get "RSS" }}
<link rel="alternate" type="application/rss+xml" title="{{ $.Site.Title }}" href="{{ .Permalink }}">
{{ end }}

<!-- Hreflang -->
{{ partial "hreflang.html" . }}

<!-- JSON-LD -->
{{ partial "seo.html" . }}

<!-- Preconnect hints for third-party domains -->
{{ with .Site.Params.googleAnalyticsId }}
<link rel="preconnect" href="https://www.googletagmanager.com">
{{ end }}
{{ if and .Site.Params.adsenseEnabled .Site.Params.adsensePubId }}
<link rel="preconnect" href="https://pagead2.googlesyndication.com">
{{ end }}

<!-- CSS -->
{{ $base := resources.Get "css/main.css" | minify }}
{{ $site := resources.Get "css/site.css" }}
{{ if $site }}
  {{ $css := slice $base $site | resources.Concat "css/bundle.css" | minify | fingerprint }}
  <link rel="stylesheet" href="{{ $css.Permalink }}">
{{ else }}
  {{ $css := $base | fingerprint }}
  <link rel="stylesheet" href="{{ $css.Permalink }}">
{{ end }}

<!-- AdSense -->
{{ partial "adsense.html" . }}

<!-- Analytics -->
{{ partial "analytics.html" . }}
